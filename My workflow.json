{
  "name": "My workflow",
  "nodes": [
    {
      "parameters": {
        "rule": {
          "interval": [
            {
              "field": "minutes"
            }
          ]
        }
      },
      "type": "n8n-nodes-base.scheduleTrigger",
      "typeVersion": 1.3,
      "position": [
        112,
        0
      ],
      "id": "64e8b7a7-9256-49a7-bddb-4cbf53090b49",
      "name": "Schedule Trigger"
    },
    {
      "parameters": {
        "promptType": "define",
        "text": "Role\n\nYou are an intelligent Daily Commute Planning Assistant.\nYour role is to analyze weather and air-quality data from a single Meteosource API and automatically plan the best travel route for the user.\n\nTask\n\nEvery day at 5:00 AM, you must:\n\nFetch current weather and air-quality data for Vijayanagara, Bengaluru using the Meteosource API\n\nAnalyze available trail/route options stored in Google Sheets\n\nSelect the most suitable route based on weather and AQI conditions\n\nCreate a Google Calendar event with the selected route\n\nSend an email to the user with route details, weather summary, and air-quality information\n\nInput\n\nYou have access to the following data:\n\nWeather & Air Quality data from Meteosource:\n\nSummary (sunny, rainy, cloudy, etc.)\n\nTemperature\n\nPrecipitation type\n\nCloud cover\n\nAQI and pollutant levels (if available)\n\nRoute options from Google Sheets (route name, suitability notes)\n\nCurrent date and time from the schedule trigger\n\nTools\n\nYou can use these tools:\n\nWeather (Meteor) ‚Üí fetches both weather and AQI for Vijayanagara, Bengaluru\n\nGoogle Sheets (Read) ‚Üí fetch available trail/route options\n\nGoogle Calendar (Create Event) ‚Üí create today‚Äôs calendar event\n\nGmail (Send Message) ‚Üí send route, weather, and AQI details\n\nMemory (Optional) ‚Üí store previous route selections\n\n‚ö†Ô∏è Do NOT call any separate AQI API.\nAll weather and AQI data must come only from the Meteosource tool.\n\nConstraints\n\nAlways run only when triggered by the 5:00 AM schedule\n\nUse today‚Äôs real-time data only\n\nChoose rain-safe routes if precipitation is detected\n\nAvoid routes marked unsafe during poor AQI\n\nKeep email clear, concise, and user-friendly\n\nDo not create duplicate calendar events for the same day\n\nDecision Logic\n\nIf summary or precipitation indicates rain or thunderstorms ‚Üí choose covered / safer route\n\nIf AQI is Poor or Very Poor ‚Üí prefer shorter or less exposed routes\n\nIf weather is clear and AQI is Good or Moderate ‚Üí choose optimal scenic route\n\nIf no suitable route exists ‚Üí notify the user via email\n\nOutput\n\nThe final output must include:\n\nSelected route name\n\nWeather summary (condition + temperature)\n\nAir quality summary (AQI level and pollutant info if available)\n\nGoogle Calendar event created for today\n\nEmail sent containing:\n\nSelected route\n\nWeather details\n\nBengaluru air quality status\n\nPrecautions or notes\n\nEmail Format (Guideline)\n\nSubject:\nToday‚Äôs Route Plan ‚Äì Weather & Air Quality Update\n\nBody should include:\n\nüå§ Weather in Vijayanagara, Bengaluru\n\nüå´ Air Quality Status\n\nüõ£ Recommended Route\n\nüìÖ Calendar event confirmation\n\nTEST MODE\n\nThis is a scheduled test run.\n\nYou MUST immediately perform the full workflow in this order:\n\nCall the Weather (Meteor) tool to fetch both weather and AQI\n\nRead available routes from Google Sheets\n\nSelect the best route based on weather and AQI\n\nCreate a Google Calendar event for today\n\nSend an email with route, weather, and AQI details\n\nDo not respond with text until all tools have been called.\nDo not skip any step.",
        "options": {}
      },
      "type": "@n8n/n8n-nodes-langchain.agent",
      "typeVersion": 3.1,
      "position": [
        584,
        0
      ],
      "id": "5dbe9e3c-53e2-4b72-ab6d-899d81f62903",
      "name": "AI Agent"
    },
    {
      "parameters": {
        "sessionIdType": "customKey",
        "sessionKey": "user-1"
      },
      "type": "@n8n/n8n-nodes-langchain.memoryBufferWindow",
      "typeVersion": 1.3,
      "position": [
        464,
        224
      ],
      "id": "4c185a75-2fb5-41a0-a9e8-aed4dc18a65e",
      "name": "Simple Memory"
    },
    {
      "parameters": {
        "model": "openai/gpt-4o-mini",
        "options": {}
      },
      "type": "@n8n/n8n-nodes-langchain.lmChatOpenRouter",
      "typeVersion": 1,
      "position": [
        336,
        224
      ],
      "id": "6295ed52-5fb8-45d8-8c5c-e5c868230df8",
      "name": "OpenRouter Chat Model",
      "credentials": {
        "openRouterApi": {
          "id": "0xpqhEu6i8WDQ0Wr",
          "name": "OpenRouter account"
        }
      }
    },
    {
      "parameters": {
        "toolDescription": "Fetches LIVE current weather and air quality for Vijayanagara, Bengaluru.\nReturns summary, temperature, precipitation, cloud cover, and AQI.\nThis tool MUST be used to obtain real-time conditions.\n",
        "url": "https://www.meteosource.com/api/v1/free/point?place_id=laggeri-10854689&sections=current&key=ama0b2o9z12nljhhneemngg5vdatm4lqx08yskdt",
        "options": {}
      },
      "type": "n8n-nodes-base.httpRequestTool",
      "typeVersion": 4.3,
      "position": [
        592,
        224
      ],
      "id": "1d5a8536-a4ea-4df4-9d90-f7fb906e7a33",
      "name": "get_weather_and_aqi"
    },
    {
      "parameters": {
        "calendar": {
          "__rl": true,
          "value": "pruthvihc29@gmail.com",
          "mode": "list",
          "cachedResultName": "pruthvihc29@gmail.com"
        },
        "additionalFields": {}
      },
      "type": "n8n-nodes-base.googleCalendarTool",
      "typeVersion": 1.3,
      "position": [
        720,
        224
      ],
      "id": "2a64f3c1-7dbb-4d39-b885-8d6bbb82420c",
      "name": "Create an event in Google Calendar",
      "credentials": {
        "googleCalendarOAuth2Api": {
          "id": "IWDBmzqU2PQP37mU",
          "name": "Google Calendar account"
        }
      }
    },
    {
      "parameters": {
        "documentId": {
          "__rl": true,
          "value": "1EPg-DGsmZFULNNocqeHp6tVnHAGfeXYclMMoPGn5whg",
          "mode": "list",
          "cachedResultName": "Trail",
          "cachedResultUrl": "https://docs.google.com/spreadsheets/d/1EPg-DGsmZFULNNocqeHp6tVnHAGfeXYclMMoPGn5whg/edit?usp=drivesdk"
        },
        "sheetName": {
          "__rl": true,
          "value": "gid=0",
          "mode": "list",
          "cachedResultName": "Sheet1",
          "cachedResultUrl": "https://docs.google.com/spreadsheets/d/1EPg-DGsmZFULNNocqeHp6tVnHAGfeXYclMMoPGn5whg/edit#gid=0"
        },
        "options": {}
      },
      "type": "n8n-nodes-base.googleSheetsTool",
      "typeVersion": 4.7,
      "position": [
        848,
        224
      ],
      "id": "9f5a2453-0eb7-4b8f-8740-626a870ae287",
      "name": "Get row(s) in sheet in Google Sheets",
      "credentials": {
        "googleSheetsOAuth2Api": {
          "id": "fymnw6CEtOvkcY4P",
          "name": "Google Sheets account"
        }
      }
    },
    {
      "parameters": {
        "sendTo": "pruthvihc29@gmail.com",
        "subject": "={{ /*n8n-auto-generated-fromAI-override*/ $fromAI('Subject', ``, 'string') }}",
        "message": "={{ /*n8n-auto-generated-fromAI-override*/ $fromAI('Message', ``, 'string') }}",
        "options": {}
      },
      "type": "n8n-nodes-base.gmailTool",
      "typeVersion": 2.2,
      "position": [
        976,
        224
      ],
      "id": "b2422210-275d-4ff5-9c4b-72e86c042654",
      "name": "Send a message in Gmail",
      "webhookId": "b9588464-52b4-49e7-8eb9-43796a0b9002",
      "credentials": {
        "gmailOAuth2": {
          "id": "0REwcpAduNrEUnR9",
          "name": "Gmail account"
        }
      }
    }
  ],
  "pinData": {},
  "connections": {
    "Schedule Trigger": {
      "main": [
        [
          {
            "node": "AI Agent",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Simple Memory": {
      "ai_memory": [
        [
          {
            "node": "AI Agent",
            "type": "ai_memory",
            "index": 0
          }
        ]
      ]
    },
    "OpenRouter Chat Model": {
      "ai_languageModel": [
        [
          {
            "node": "AI Agent",
            "type": "ai_languageModel",
            "index": 0
          }
        ]
      ]
    },
    "get_weather_and_aqi": {
      "ai_tool": [
        [
          {
            "node": "AI Agent",
            "type": "ai_tool",
            "index": 0
          }
        ]
      ]
    },
    "Create an event in Google Calendar": {
      "ai_tool": [
        [
          {
            "node": "AI Agent",
            "type": "ai_tool",
            "index": 0
          }
        ]
      ]
    },
    "Get row(s) in sheet in Google Sheets": {
      "ai_tool": [
        [
          {
            "node": "AI Agent",
            "type": "ai_tool",
            "index": 0
          }
        ]
      ]
    },
    "Send a message in Gmail": {
      "ai_tool": [
        [
          {
            "node": "AI Agent",
            "type": "ai_tool",
            "index": 0
          }
        ]
      ]
    }
  },
  "active": false,
  "settings": {
    "executionOrder": "v1",
    "availableInMCP": false
  },
  "versionId": "09cb4b99-3a8c-4a33-878c-c1d0cbac8d5d",
  "meta": {
    "templateCredsSetupCompleted": true,
    "instanceId": "e4f999e832c2c48b6f7db2184c9a8d781f0cba9a75ae323edb29d23f4cfee489"
  },
  "id": "EQF8r_YVny1zZcQZP6w9p",
  "tags": []
}